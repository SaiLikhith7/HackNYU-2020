<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    </head>
    <body>
        <form id="upload-file" method="post" enctype="multipart/form-data">
            <fieldset>
                <label for="file">Select a file</label>
                <input name="file" type="file">
            </fieldset>
            <fieldset>
                <button id="upload-file-btn" type="button">Upload</button>
            </fieldset>
        </form>
        
        <script>
            $(function() {
                $('#upload-file-btn').click(function() {
                    var form_data = new FormData($('#upload-file')[0]);
                    $.ajax({
                        type: 'POST',
                        url: '/uploadajax',
                        data: form_data,
                        contentType: false,
                        cache: false,
                        processData: false,
                        success: function(filename) {
                            console.log(filename);
                            setInterval(fetchdetails,1000, filename);
                        },
                    });
                });
            });


            function fetchdetails(filename){
                var data = {'filename':filename}
                $.ajax({
                url: '/fetchdetails',
                type: 'post',
                data: data,
                dataType: "json",
                success: function(response){
                    console.log(response);
                    // Perform operation on the return value
                    if(response!=""){alert(response['text']);}
                }
                });
                }
            </script>
        
    </body>
    
</html>